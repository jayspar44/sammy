# Sammy - AI Habit Companion

An AI-powered habit tracking application to help users moderate or quit drinking and build healthier habits with proactive AI support.

## Architecture

**Full-stack monorepo** with:
- **Frontend**: React 19 + Vite + Tailwind CSS (web) + Capacitor (mobile)
- **Backend**: Node.js 22 + Express 5 REST API
- **Database**: Firebase Firestore
- **Authentication**: Firebase Auth (Email/Password)
- **AI**: Google Gemini 2.5 Flash

## Project Structure

```
sammy-1/
â”œâ”€â”€ frontend/                 # React + Vite web app
â”‚   â”œâ”€â”€ src/
â”‚   â”‚   â”œâ”€â”€ pages/           # Home, Companion, Insights, Settings, Login
â”‚   â”‚   â”œâ”€â”€ components/      # UI components (layout/, common/, ui/)
â”‚   â”‚   â”œâ”€â”€ contexts/        # AuthContext, UserPreferencesContext, ConnectionContext, ThemeContext
â”‚   â”‚   â”œâ”€â”€ api/             # Axios client and API services
â”‚   â”‚   â””â”€â”€ utils/           # Helper functions
â”‚   â””â”€â”€ capacitor.config.json # Mobile app config (io.sammy.app)
â”œâ”€â”€ backend/                  # Express API server
â”‚   â”œâ”€â”€ src/
â”‚   â”‚   â”œâ”€â”€ index.js         # Server entry point
â”‚   â”‚   â”œâ”€â”€ routes/api.js    # Route definitions
â”‚   â”‚   â”œâ”€â”€ controllers/     # auth, log, user, chat controllers
â”‚   â”‚   â””â”€â”€ services/        # firebase, ai, stats services
â”‚   â””â”€â”€ Dockerfile           # Cloud Run container config
â”œâ”€â”€ .claude/                  # Claude Code configuration
â”‚   â””â”€â”€ commands/            # Custom slash commands (skills)
â”‚       â”œâ”€â”€ architect.md     # Architecture review and consultation
â”‚       â”œâ”€â”€ code-review.md   # Multi-agent code review
â”‚       â”œâ”€â”€ pr-flow.md       # Autonomous PR workflow
â”‚       â”œâ”€â”€ pr-merge.md      # Smart PR merge with sync
â”‚       â”œâ”€â”€ feature-start.md # Feature branch creation
â”‚       â”œâ”€â”€ lint-check.md    # ESLint validation
â”‚       â”œâ”€â”€ version.md       # Version bumping
â”‚       â””â”€â”€ build-app.md     # Android APK builds
â”œâ”€â”€ .github/workflows/        # GitHub Actions
â”‚   â”œâ”€â”€ build-apk.yml        # On-demand APK/AAB builds
â”‚   â”œâ”€â”€ upload-play-store.yml # Play Store uploads
â”‚   â”œâ”€â”€ pr-preview-cleanup.yml # PR preview cleanup
â”‚   â”œâ”€â”€ pr-validation.yml    # PR linting and build checks
â”‚   â”œâ”€â”€ claude-pr-review.yml # Claude Code PR reviews
â”‚   â””â”€â”€ version-tag.yml      # Auto-tag version bumps
â”œâ”€â”€ scripts/                  # Dev tooling
â”œâ”€â”€ cloudbuild.yaml          # CI/CD pipeline (dev/prod)
â”œâ”€â”€ cloudbuild-preview.yaml  # PR preview environments
â”œâ”€â”€ cloud-run.config.json    # Cloud Run service URLs and patterns
â”œâ”€â”€ firebase.json            # Firebase project config
â””â”€â”€ version.json             # Centralized version number
```

## Environments

| Environment | Branch/Trigger | Backend URL                              | Frontend              |
|-------------|----------------|------------------------------------------|-----------------------|
| Local       | any            | http://localhost:4001                    | http://localhost:4000 |
| Dev (GCP)   | develop        | https://sammy-backend-dev-u7dzitmnha-uc.a.run.app | https://sammy-658-dev.web.app |
| Prod (GCP)  | main           | https://sammy-backend-prod-u7dzitmnha-uc.a.run.app | https://sammy-658.web.app |
| PR Preview  | PR to develop  | https://pr-{N}---sammy-backend-dev-u7dzitmnha-uc.a.run.app | https://sammy-658--pr-{N}-{hash}.web.app |

**PR Preview URLs:**
- `{N}` is the PR number
- `{hash}` is a unique identifier generated by Firebase Hosting
- Backend uses Cloud Run tags (no traffic to main service)
- Frontend uses Firebase Hosting preview channels
- Automatically cleaned up when PR is closed

## Local Development

### Prerequisites
- Node.js 22+
- npm

### Setup

```bash
# Install all dependencies (root, frontend, backend)
npm run install-all

# Configure environment variables
cp backend/.env.example backend/.env
cp frontend/.env.local.template frontend/.env.local
# Edit both files with your credentials
```

### Running Locally

```bash
# Start both frontend and backend (recommended)
npm run dev:local
# Frontend: http://localhost:4000
# Backend:  http://localhost:4001

# Or run separately
npm run dev:frontend   # Frontend only
npm run dev:backend    # Backend only
```

### Dev Server Management

```bash
npm run dev:local:list  # List running dev servers
npm run dev:local:kill  # Kill running dev servers
```

## Environment Variables

### Backend (`backend/.env`)

| Variable                 | Description                          |
|--------------------------|--------------------------------------|
| `PORT`                   | Server port (default: 4001)          |
| `FIREBASE_SERVICE_ACCOUNT` | Firebase Admin SDK service account JSON |
| `GEMINI_API_KEY`         | Google Gemini API key                |
| `NODE_ENV`               | Environment (development/production) |
| `ALLOWED_ORIGINS`        | CORS allowed origins (comma-separated) |

### Frontend (`frontend/.env.local`)

| Variable              | Description                          |
|-----------------------|--------------------------------------|
| `VITE_API_URL`        | Backend API URL (default: /api)      |
| `VITE_FIREBASE_CONFIG` | Firebase client config JSON         |

## API Endpoints

All endpoints (except health) require Firebase Auth token in `Authorization: Bearer <token>` header.

| Method | Endpoint              | Description                |
|--------|-----------------------|----------------------------|
| GET    | `/api/health`         | Health check with version info (public) |
| POST   | `/api/log`            | Log a drink                |
| PUT    | `/api/log`            | Update a log entry         |
| DELETE | `/api/log`            | Delete a log entry         |
| GET    | `/api/stats`          | Get user statistics        |
| GET    | `/api/stats/range`    | Get stats for date range   |
| POST   | `/api/user/profile`   | Create/update user profile |
| GET    | `/api/user/profile`   | Get user profile           |
| POST   | `/api/chat`           | Send message to AI companion |
| GET    | `/api/chat/history`   | Get chat history           |
| DELETE | `/api/chat/history`   | Clear chat history         |

**Health Endpoint Response:**
```json
{
  "status": "ok",
  "timestamp": "2026-01-14T12:34:56.789Z",
  "version": "0.11.3",
  "buildTimestamp": "2026-01-14T10:30:00.000Z"
}
```

## Mobile (Android/iOS)

The app uses Capacitor for native mobile builds. Three Android product flavors exist with separate app IDs so all can be installed on the same device.

| Script | App ID | App Name | Backend | Use Case |
|--------|--------|----------|---------|----------|
| `android:local` | `io.sammy.app.local` | Sammy (Local) | Local backend | Local development |
| `android:local-livereload` | `io.sammy.app.local` | Sammy (Local) | Local (live reload) | Active development |
| `android:dev` | `io.sammy.app.dev` | Sammy (Dev) | GCP dev backend | Testing dev builds |
| `android` | `io.sammy.app` | Sammy | GCP prod backend | Production builds |

### Android Build Variants

Each flavor has debug and release variants. In Android Studio, select the build variant:
- **localDebug** - Local backend development
- **devDebug** - Dev backend testing
- **prodDebug** - Prod backend debugging
- **prodRelease** - Production release (for Play Store)

### Android Setup (First Time)

```bash
cd frontend
npx cap add android        # Add Android platform
npx cap open android       # Open in Android Studio
```

### Android Development

```bash
# Local build (points to local backend)
npm run android:local      # Then open Android Studio and run

# Live reload (for active development)
# Terminal 1: Start local dev servers
npm run dev:local
# Terminal 2: Run Android with live reload
npm run android:local-livereload   # Select emulator, changes auto-reload
```

### Android Builds

```bash
# Local build (points to local backend)
npm run android:local      # Then open Android Studio and run

# Dev build (points to GCP dev backend)
npm run android:dev        # Then open Android Studio and run

# Prod build (points to GCP prod backend)
npm run android            # Then open Android Studio and run

# Open Android Studio
npx cap open android
```

### Build APK (No Android Studio)

Build APKs directly via Gradle and copy to Google Drive:

```bash
# Default: dev debug
npm run apk               # Build devDebug APK

# Specific variants
npm run apk:dev           # Build devDebug APK
npm run apk:local         # Build localDebug APK
npm run apk:prod          # Build prodRelease APK

# Custom variant (from frontend dir)
cd frontend && node scripts/build-apk.js prod debug
```

APKs are automatically copied to `G:\My Drive\sammy` with versioned filenames:
- `sammy-dev-debug-v0.10.8-20260111-1430.apk`

### Build for iOS

```bash
cd frontend
npm run build
npx cap add ios
npx cap sync ios
npx cap open ios           # Open in Xcode
```

### Quick Android Reference

| I want to...                    | Run this                        | Then in Android Studio      |
|---------------------------------|---------------------------------|-----------------------------|
| Build local app                 | `npm run android:local`         | Select `localDebug` variant |
| Develop with live reload        | `npm run android:local-livereload` | (auto-selects device)    |
| Test against GCP dev backend    | `npm run android:dev`           | Select `devDebug` variant   |
| Build production app            | `npm run android`               | Select `prodDebug` variant  |

**Tips:**
- The build script shows a colored banner indicating which environment you're building
- For `android:local-livereload`, start `npm run dev:local` first in a separate terminal
- For `android:local`, only `npm run dev:backend` needs to be running when testing
- Check **Settings > App Info** in the app to verify environment and build timestamp
- All three app variants can be installed on the same device (different app IDs)

## Linting

ESLint is configured for both frontend and backend. Run linting before committing changes.

```bash
# Lint both frontend and backend
npm run lint

# Lint individually
npm run lint --prefix frontend
npm run lint --prefix backend
```

## Useful Commands

### NPM Scripts

| Command                    | Description                          |
|----------------------------|--------------------------------------|
| `npm run dev:local`        | Start local dev servers              |
| `npm run build`            | Build frontend for production        |
| `npm run android`          | Build prod Android app               |
| `npm run android:dev`      | Build dev Android app                |
| `npm run android:local`    | Build local Android app              |
| `npm run android:local-livereload` | Android with live reload   |
| `npm run apk`              | Build devDebug APK to Google Drive   |
| `npm run apk:dev`          | Build devDebug APK to Google Drive   |
| `npm run apk:local`        | Build localDebug APK to Google Drive |
| `npm run apk:prod`         | Build prodRelease APK to Google Drive|
| `npm run lint`             | Run ESLint on frontend and backend   |
| `npm run validate-env`     | Validate environment configuration   |
| `npm run version:get`      | Get current version                  |
| `npm run version:patch -- "msg"` | Patch bump (bug fixes)         |
| `npm run version:minor -- "msg"` | Minor bump (new features)      |
| `npm run version:major -- "msg"` | Major bump (breaking changes)  |

### Claude Code Slash Commands

| Command                    | Description                          |
|----------------------------|--------------------------------------|
| `/feature-start <name>`    | Create and switch to feature branch  |
| `/lint-check [--fix]`      | Run ESLint (with optional auto-fix)  |
| `/code-review [pr\|branch]`| Multi-agent code review (4 agents)   |
| `/pr-flow`                 | Autonomous PR workflow with auto-fix |
| `/pr-merge <pr-number>`    | Squash merge PR with auto-sync       |
| `/version [type] [msg]`    | Bump version (auto-detects if omitted)|
| `/build-app [env]`         | Build Android APK to Google Drive    |
| `/architect <mode> <topic>`| Architecture consultation/review     |

## Firebase

- **Project ID**: sammy-658
- **Region**: nam5 (North America)
- **Firestore Rules**: `firestore.rules` (secure, field-validated)
- **Indexes**: `firestore.indexes.json`

### Firestore Security

Firestore rules enforce:
- **User isolation**: Users can only access their own data
- **Authentication**: All operations require valid Firebase Auth
- **Field validation**: Writes validated for required fields and types
- **Timestamp integrity**: Server-side timestamps enforced
- **No public access**: All collections require authentication

**Protected Collections:**
- `users` - User profiles
- `logs` - Drink logs
- `chat_sessions` - AI chat history

### Deploy Firestore Rules

```bash
firebase deploy --only firestore:rules
```

## GCP Deployment

### Automated Deployments

Deployment uses Cloud Build with branch push and PR triggers.

| Component | Service | Trigger | Config File |
|-----------|---------|---------|-------------|
| Backend (dev/prod) | Cloud Run | Push to develop/main | `cloudbuild.yaml` |
| Frontend (dev/prod) | Firebase Hosting | Push to develop/main | `cloudbuild.yaml` |
| PR Previews | Cloud Run + Firebase | PR to develop | `cloudbuild-preview.yaml` |

### CI/CD Triggers

- **develop branch** â†’ Deploys to dev environment
- **main branch** â†’ Deploys to prod environment
- **Pull Request to develop** â†’ Deploys preview environment

### PR Preview Environments

When a PR is opened against `develop`, Cloud Build automatically creates a preview environment:

**Preview URLs:**
- **Backend**: `https://pr-{N}---sammy-backend-dev-u7dzitmnha-uc.a.run.app`
- **Frontend**: `https://sammy-658--pr-{N}-{hash}.web.app`

Where `{N}` is the PR number.

**How it works:**
1. Backend deployed to Cloud Run with tag `pr-{N}` (no traffic to main service)
2. Frontend deployed to Firebase Hosting preview channel
3. Backend CORS updated to allow the preview frontend URL
4. Preview expires after 7 days or when PR is closed

**Cleanup:**
- Automatic cleanup via GitHub Actions when PR is closed (`.github/workflows/pr-preview-cleanup.yml`)
- Removes Cloud Run tag and Firebase preview channel

### Automatic Version Tags

Git tags are automatically created when version bumps are pushed to `develop` or `main` (`.github/workflows/version-tag.yml`):

- **Minor/Major bumps** â†’ Tag `v{version}` created automatically
- **Patch bumps** â†’ No tag created

### PR Validation

Pull requests to `develop` or `main` trigger automated validation (`.github/workflows/pr-validation.yml`):

1. **ESLint** - Runs on both frontend and backend
2. **Build** - Validates frontend builds successfully
3. **Code checks** - Warns about `console.log` and `TODO` comments

PRs are blocked from merging if lint or build fails.

### Android Builds (GitHub Actions)

On-demand Android APK/AAB builds via GitHub Actions (`.github/workflows/build-apk.yml`):

**Trigger**: Manual (workflow_dispatch)

**Options:**
- **Flavor**: `dev` or `prod`
- **Build Type**: `debug` or `release`
- **Output Format**: `apk` or `aab` (Android App Bundle)
- **API URL**: Configurable backend URL (for PR previews)

**Usage:**
1. Go to Actions â†’ Build Android
2. Click "Run workflow"
3. Select options (flavor, build type, output format)
4. Enter API URL (or use default)
5. Download from workflow artifacts

**Use Cases:**
- Build APKs for specific PR preview environments
- Generate AABs for Play Store submission
- Test different backend environments without local setup

### Play Store Uploads (GitHub Actions)

Automated uploads to Google Play Store (`.github/workflows/upload-play-store.yml`):

**Trigger**: Manual (workflow_dispatch)

**Options:**
- **Track**: `internal`, `alpha`, or `beta`
- **Release Notes**: Optional description

**What it does:**
1. Builds production AAB (signed release)
2. Uploads to specified Play Store track
3. Creates release with version from `package.json`

**Prerequisites:**
- Keystore uploaded to GitHub Secrets (`KEYSTORE_BASE64`)
- Play Store service account configured (`PLAY_SERVICE_ACCOUNT_JSON`)
- App created in Play Console

**Usage:**
1. Go to Actions â†’ Upload to Play Store
2. Click "Run workflow"
3. Select track and add release notes
4. Check Play Console for release status

### Branch Protection

| Branch | Requires PR | Direct Push | Force Push | Delete |
|--------|-------------|-------------|------------|--------|
| `main` | Yes | Blocked | Blocked | Blocked |
| `develop` | No | Allowed | Blocked | Blocked |

- **main**: All changes must go through a PR (no direct commits)
- **develop**: Direct commits allowed for owner and Claude Code App
- Only repository owner can push to protected branches

### Claude Code Reviews

Claude Code reviews PRs via GitHub Actions (`.github/workflows/claude-pr-review.yml`):

- **Automatic**: PRs targeting `main` are reviewed automatically when opened or updated
- **On-demand**: Mention `@claude` in any PR comment to request a review or ask questions

### Manual Deployment

```bash
# Backend to Cloud Run (Dev)
cd backend
gcloud run deploy sammy-backend-dev \
  --source . \
  --region us-central1 \
  --allow-unauthenticated \
  --set-secrets="FIREBASE_SERVICE_ACCOUNT=FIREBASE_SERVICE_ACCOUNT:latest,GEMINI_API_KEY=GEMINI_API_KEY:latest" \
  --set-env-vars="NODE_ENV=dev" \
  --set-env-vars="^@^ALLOWED_ORIGINS=https://sammy-658-dev.web.app,https://sammy-658.web.app,capacitor://localhost"

# Frontend to Firebase Hosting (Dev)
cd frontend
FIREBASE_CONFIG='{"apiKey":"...","authDomain":"sammy-658.firebaseapp.com","projectId":"sammy-658","storageBucket":"sammy-658.firebasestorage.app","messagingSenderId":"...","appId":"...","measurementId":"..."}'
echo "VITE_API_URL=https://sammy-backend-dev-607940169476.us-central1.run.app/api" > .env.production
echo "VITE_FIREBASE_CONFIG=$FIREBASE_CONFIG" >> .env.production
npm run build
firebase deploy --only hosting:dev

# Or use the setup script (run once)
./scripts/setup-deployment.sh
```

### GCP Setup (First Time)

See the deployment plan for full setup instructions:
1. Enable required APIs (run, cloudbuild, secretmanager)
2. Create secrets in Secret Manager
3. Grant Cloud Build permissions
4. Create Cloud Build triggers

## Tech Stack

| Layer      | Technology         | Version |
|------------|--------------------|---------|
| Frontend   | React              | 19.2.3  |
| Build      | Vite               | 7.3.0   |
| Styling    | Tailwind CSS       | 4.1.18  |
| Backend    | Express.js         | 5.2.1   |
| Runtime    | Node.js            | 22      |
| Database   | Firebase Firestore | -       |
| Auth       | Firebase Auth      | -       |
| AI         | Google Gemini      | 2.5     |
| Mobile     | Capacitor          | 8.0.0   |
| Backend Hosting | Google Cloud Run | -  |
| Frontend Hosting | Firebase Hosting | - |
| CI/CD      | Google Cloud Build | -       |

## Security

### ğŸš¨ CRITICAL: Never Commit Secrets

**NEVER commit any file containing secrets, credentials, or API keys to git.**

#### Protected Files (Must NEVER be committed)
- `.env` (backend)
- `.env.local` (frontend)
- `.env.dev` (frontend)
- `.env.production` (frontend)
- `.env.android-local` (frontend)
- `.env.local-build` (frontend)
- Any file matching `.env*` EXCEPT `.env.example` or `.env.template` files

#### Gitignore Patterns
Both `.gitignore` files ignore all `.env*` files except templates/examples:

**Backend** (`backend/.gitignore`):
```gitignore
.env*
!.env.example
```

**Frontend** (`frontend/.gitignore`):
```gitignore
.env*
!.env.local.template
!.env.production.example
!.env*.example
!.env*.template
```

#### What Contains Secrets
- **Firebase Config**: Contains API keys (even though client-side, should not be in git)
- **Backend ENV**: Contains Firebase service account JSON, Gemini API key
- **Any file with `apiKey`, `serviceAccount`, or similar sensitive data**

#### GCP Secret Manager
Production secrets are stored in GCP Secret Manager:
- `FIREBASE_CLIENT_CONFIG` - Frontend Firebase config (used by Cloud Build)
- `FIREBASE_SERVICE_ACCOUNT` - Backend Admin SDK credentials
- `GEMINI_API_KEY` - AI API access

#### If a Secret Leaks
1. **Rotate the key immediately** in Google Cloud Console
2. **Update all environment files** with new key
3. **Update GCP Secret Manager** with new key
4. **Delete the old key** from Google Cloud Console
5. **Do NOT commit the updated .env files** - they're still ignored
6. If the key was pushed to GitHub, consider git history cleanup (but rotation is most critical)

#### Before Committing
Always verify you're not about to commit secrets:
```bash
git status          # Check what's staged
git diff --cached   # Review staged changes
```

If you see any `.env` file (except `.env.example` or `.env.template`), **STOP** and ensure it's in `.gitignore`.

## Claude Code Skills & Commands

The project includes custom Claude Code slash commands (`.claude/commands/`) for development workflows:

### Development Workflow Commands

| Command | Description | Usage |
|---------|-------------|-------|
| `/feature-start` | Create and switch to new feature branch | `/feature-start <name> [base-branch]` |
| `/lint-check` | Run ESLint on frontend and backend | `/lint-check [--fix]` |
| `/code-review` | Multi-agent code review (4 parallel agents) | `/code-review [pr-number\|branch]` |
| `/pr-flow` | Autonomous PR workflow with auto-fix | `/pr-flow [--no-fix] [--auto-merge]` |
| `/pr-merge` | Squash merge PR with auto-sync | `/pr-merge <pr-number> [--no-sync] [--delete-branch]` |
| `/version` | Bump version (patch/minor/major) | `/version [patch\|minor\|major] [description]` |
| `/build-app` | Build Android APK to Google Drive | `/build-app [local\|dev\|prod]` |
| `/architect` | Architecture expert consultation/review | `/architect [consult\|review\|audit] <topic-or-path>` |

### Workflow Examples

**Feature Development:**
```bash
/feature-start my-feature    # Create feature branch from develop
# ... make changes ...
/lint-check --fix            # Fix linting issues
/code-review                 # Pre-PR review (4-agent analysis)
/pr-flow                     # Create PR, auto-fix issues, merge
```

**Version Bump and Release:**
```bash
/version minor "Add new feature"  # Bump version
# Commit created automatically
```

**Architecture Review:**
```bash
/architect review frontend/src/contexts/AuthContext.jsx
/architect consult offline-first state management strategy
/architect audit authentication flow
```

### Multi-Agent Code Review

The `/code-review` command launches **4 specialized parallel agents**:

1. **Security Scanner** ğŸ”’ - Auth checks, secrets, input validation, data exposure
2. **Standards Enforcer** ğŸ“‹ - CLAUDE.md compliance, naming conventions, patterns
3. **Logic Analyzer** ğŸ” - Bugs, error handling, edge cases, race conditions
4. **Performance Guardian** âš¡ - Rate limits, unbounded queries, memory leaks, cost control

**Severity Levels:**
- ğŸ”´ **BLOCKING** - Cannot merge (security, broken functionality)
- ğŸŸ¡ **HIGH** - Should fix (standards violations, missing error handling)
- ğŸŸ¢ **MEDIUM** - Fix in follow-up (code clarity, minor refactoring)
- â„¹ï¸ **INFO** - Optional (style suggestions, alternatives)

**Auto-fix in /pr-flow:**
The `/pr-flow` command uses `/code-review` internally and automatically fixes blocking/high issues (up to 3 iterations).

**GitHub Issue Tracking:**
If high-priority issues cannot be auto-fixed, `/pr-flow` offers to create GitHub issues to track them for follow-up. Each issue includes:
- Full problem description and context
- File location and code snippets
- Suggested fix from the reviewing agent
- Labeled with `code-review` and `high-priority`

## Coding Conventions

### Naming
- **Files**: kebab-case (e.g., `user-profile.js`, `api-routes.js`)
- **React Components**: PascalCase (e.g., `UserProfile.jsx`)
- **Variables/Functions**: camelCase
- **Directories**: kebab-case

### Frontend Patterns
- **State**: React Context for global state (Auth, Theme). Local state for components.
- **API**: Use the `api/` directory for Axios wrappers. Do not make raw fetch calls in components.
- **Styling**: Tailwind CSS utility classes. Use CSS variables for theming in `index.css`.
- **Mobile**: Capacitor is used. Avoid browser-only APIs without checks.

### Backend Patterns
- **Structure**: Controller-Service pattern
  - `routes/`: Express routers
  - `controllers/`: Request handling logic
  - `services/`: Business logic, AI integration, Firebase calls
- **Logging**: Use `req.log` (Pino) instead of `console.log`

### Git Commits
- **Version prefix**: Include current version in commit messages (e.g., `v0.4.0: Add dark mode toggle`)
